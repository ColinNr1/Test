<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<title>Simple Excel Viewer – VIP Portfolio</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Excel Library -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.19.3/dist/xlsx.full.min.js"></script>

<style>
body{
  background:#0b1020;
  color:#e7ecff;
  font-family:Arial, sans-serif;
  margin:20px;
}
h1{margin-bottom:10px}
input,button{
  padding:10px;
  margin:5px 0;
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:20px;
  font-size:12px;
}
th,td{
  border:1px solid #333;
  padding:6px;
}
th{
  background:#101a33;
  position:sticky;
  top:0;
}
tr:nth-child(even){
  background:#111;
}
</style>
</head>

<body>

<h1>VIP Portfolio – Excel Import (Simple)</h1>

<input type="file" id="fileInput" accept=".xlsx,.xls,.csv">
<button onclick="importFile()">Importieren</button>

<div id="status"></div>

<table id="table">
  <thead></thead>
  <tbody></tbody>
</table>

<script>
function importFile(){
  const file = document.getElementById("fileInput").files[0];
  if(!file){
    alert("Bitte zuerst eine Datei auswählen");
    return;
  }

  const ext = file.name.split(".").pop().toLowerCase();

  if(ext === "csv"){
    file.text().then(text => {
      const rows = text.split(/\r?\n/).map(r => r.split(","));
      renderTable(rows);
    });
  } 
  else {
    const reader = new FileReader();
    reader.onload = e => {
      const data = new Uint8Array(e.target.result);
      const wb = XLSX.read(data, { type: "array" });
      const sheet = wb.Sheets[wb.SheetNames[0]];
      const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });
      renderTable(rows);
    };
    reader.readAsArrayBuffer(file);
  }
}

function renderTable(rows){
  if(!rows || !rows.length){
    alert("Keine Daten gefunden");
    return;
  }

  const thead = document.querySelector("#table thead");
  const tbody = document.querySelector("#table tbody");

  thead.innerHTML = "";
  tbody.innerHTML = "";

  // Header
  const hrow = document.createElement("tr");
  rows[0].forEach(h => {
    const th = document.createElement("th");
    th.textContent = h;
    hrow.appendChild(th);
  });
  thead.appendChild(hrow);

  // Rows
  for(let i=1;i<rows.length;i++){
    const tr = document.createElement("tr");
    rows[i].forEach(c => {
      const td = document.createElement("td");
      td.textContent = c ?? "";
      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  }

  document.getElementById("status").textContent =
    `Import erfolgreich – ${rows.length - 1} Zeilen geladen`;
}
</script>

</body>
</html>
